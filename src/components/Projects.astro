---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";

const projects = await getCollection("labs");
const sortedProjects = projects
  .sort((a: any, b: any) => a.data.priority - b.data.priority)
  .slice(0, 4);
---

<div class="h-full flex flex-col justify-center max-w-6xl mx-auto px-4 py-12">
  <h2 class="text-3xl font-bold mb-12 text-center md:text-left">
    <span class="text-primary">/</span> work
  </h2>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    {
      sortedProjects.map((project: any) => (
        <a
          href={project.data.link}
          target="_blank"
          rel="noopener noreferrer"
          class="card-terminal group hover:border-primary/50 transition-all duration-300 overflow-hidden flex flex-col h-full"
        >
          <div class="h-48 overflow-hidden relative border-b border-base-content/10">
            <Image
              src={project.data.image}
              alt={project.data.title}
              class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
            />
            <div class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity">
              <span class="badge badge-primary badge-outline bg-base-100">
                visit â†—
              </span>
            </div>
          </div>

          <div class="p-6 flex flex-col flex-1">
            <h4 class="text-xl font-bold text-base-content group-hover:text-primary transition-colors mb-3">
              {project.data.title}
            </h4>

            <p class="text-sm text-base-content/70 mb-6 leading-relaxed line-clamp-3">
              {project.data.description}
            </p>

            <div class="flex flex-wrap gap-2 mt-auto">
              {project.data.tags.map((tech: string) => (
                <span class="text-xs text-base-content/50 bg-base-content/5 px-2 py-1 rounded border border-base-content/5">
                  {tech}
                </span>
              ))}
            </div>
          </div>
        </a>
      ))
    }
  </div>
</div>
